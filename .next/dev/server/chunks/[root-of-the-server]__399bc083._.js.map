{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 52, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/avbha/OneDrive/Desktop/projects/educify/lib/prisma.ts"],"sourcesContent":["import { PrismaClient } from \"@prisma/client\";\n\nconst globalForPrisma = globalThis as unknown as { prisma: PrismaClient };\n\nexport const prisma =\n  globalForPrisma.prisma ||\n  new PrismaClient({\n    log: process.env.NODE_ENV === \"development\" ? [\"query\", \"info\"] : [\"error\"],\n  });\n\nif (process.env.NODE_ENV !== \"production\") globalForPrisma.prisma = prisma;\n"],"names":[],"mappings":";;;;AAAA;;AAEA,MAAM,kBAAkB;AAEjB,MAAM,SACX,gBAAgB,MAAM,IACtB,IAAI,6IAAY,CAAC;IACf,KAAK,uCAAyC;QAAC;QAAS;KAAO,GAAG;AACpE;AAEF,wCAA2C,gBAAgB,MAAM,GAAG"}},
    {"offset": {"line": 70, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/avbha/OneDrive/Desktop/projects/educify/lib/api-utils.ts"],"sourcesContent":["/**\n * API Response utilities\n */\n\nexport interface ApiResponse<T = null> {\n  success: boolean;\n  data?: T;\n  error?: string;\n  message?: string;\n}\n\nexport function successResponse<T>(data: T, message?: string): ApiResponse<T> {\n  return {\n    success: true,\n    data,\n    message,\n  };\n}\n\nexport function errorResponse(error: string): ApiResponse {\n  return {\n    success: false,\n    error,\n  };\n}\n\n/**\n * Pagination utilities\n */\nexport interface PaginationParams {\n  page: number;\n  limit: number;\n}\n\nexport interface PaginatedResponse<T> {\n  data: T[];\n  pagination: {\n    page: number;\n    limit: number;\n    total: number;\n    pages: number;\n  };\n}\n\nexport function calculateSkip(page: number, limit: number): number {\n  return (page - 1) * limit;\n}\n\nexport function calculatePages(total: number, limit: number): number {\n  return Math.ceil(total / limit);\n}\n\nexport function createPaginatedResponse<T>(\n  data: T[],\n  total: number,\n  page: number,\n  limit: number\n): PaginatedResponse<T> {\n  return {\n    data,\n    pagination: {\n      page,\n      limit,\n      total,\n      pages: calculatePages(total, limit),\n    },\n  };\n}\n\n/**\n * Error handling\n */\nexport class AppError extends Error {\n  constructor(public statusCode: number, message: string) {\n    super(message);\n    this.name = \"AppError\";\n  }\n}\n\nexport class ValidationError extends AppError {\n  constructor(message: string) {\n    super(400, message);\n    this.name = \"ValidationError\";\n  }\n}\n\nexport class NotFoundError extends AppError {\n  constructor(resource: string) {\n    super(404, `${resource} not found`);\n    this.name = \"NotFoundError\";\n  }\n}\n\nexport class UnauthorizedError extends AppError {\n  constructor(message: string = \"Unauthorized\") {\n    super(401, message);\n    this.name = \"UnauthorizedError\";\n  }\n}\n\nexport class ForbiddenError extends AppError {\n  constructor(message: string = \"Forbidden\") {\n    super(403, message);\n    this.name = \"ForbiddenError\";\n  }\n}\n\nexport class ConflictError extends AppError {\n  constructor(message: string) {\n    super(409, message);\n    this.name = \"ConflictError\";\n  }\n}\n\n/**\n * Request parsing utilities\n */\nexport async function parseJsonBody(request: Request): Promise<any> {\n  try {\n    return await request.json();\n  } catch (error) {\n    throw new ValidationError(\"Invalid JSON in request body\");\n  }\n}\n\nexport async function parseFormData(request: Request): Promise<FormData> {\n  try {\n    return await request.formData();\n  } catch (error) {\n    throw new ValidationError(\"Invalid form data in request\");\n  }\n}\n"],"names":[],"mappings":"AAAA;;CAEC;;;;;;;;;;;;;;;;;;;;;;;;;;;;AASM,SAAS,gBAAmB,IAAO,EAAE,OAAgB;IAC1D,OAAO;QACL,SAAS;QACT;QACA;IACF;AACF;AAEO,SAAS,cAAc,KAAa;IACzC,OAAO;QACL,SAAS;QACT;IACF;AACF;AAoBO,SAAS,cAAc,IAAY,EAAE,KAAa;IACvD,OAAO,CAAC,OAAO,CAAC,IAAI;AACtB;AAEO,SAAS,eAAe,KAAa,EAAE,KAAa;IACzD,OAAO,KAAK,IAAI,CAAC,QAAQ;AAC3B;AAEO,SAAS,wBACd,IAAS,EACT,KAAa,EACb,IAAY,EACZ,KAAa;IAEb,OAAO;QACL;QACA,YAAY;YACV;YACA;YACA;YACA,OAAO,eAAe,OAAO;QAC/B;IACF;AACF;AAKO,MAAM,iBAAiB;;IAC5B,YAAY,AAAO,UAAkB,EAAE,OAAe,CAAE;QACtD,KAAK,CAAC,eADW,aAAA;QAEjB,IAAI,CAAC,IAAI,GAAG;IACd;AACF;AAEO,MAAM,wBAAwB;IACnC,YAAY,OAAe,CAAE;QAC3B,KAAK,CAAC,KAAK;QACX,IAAI,CAAC,IAAI,GAAG;IACd;AACF;AAEO,MAAM,sBAAsB;IACjC,YAAY,QAAgB,CAAE;QAC5B,KAAK,CAAC,KAAK,GAAG,SAAS,UAAU,CAAC;QAClC,IAAI,CAAC,IAAI,GAAG;IACd;AACF;AAEO,MAAM,0BAA0B;IACrC,YAAY,UAAkB,cAAc,CAAE;QAC5C,KAAK,CAAC,KAAK;QACX,IAAI,CAAC,IAAI,GAAG;IACd;AACF;AAEO,MAAM,uBAAuB;IAClC,YAAY,UAAkB,WAAW,CAAE;QACzC,KAAK,CAAC,KAAK;QACX,IAAI,CAAC,IAAI,GAAG;IACd;AACF;AAEO,MAAM,sBAAsB;IACjC,YAAY,OAAe,CAAE;QAC3B,KAAK,CAAC,KAAK;QACX,IAAI,CAAC,IAAI,GAAG;IACd;AACF;AAKO,eAAe,cAAc,OAAgB;IAClD,IAAI;QACF,OAAO,MAAM,QAAQ,IAAI;IAC3B,EAAE,OAAO,OAAO;QACd,MAAM,IAAI,gBAAgB;IAC5B;AACF;AAEO,eAAe,cAAc,OAAgB;IAClD,IAAI;QACF,OAAO,MAAM,QAAQ,QAAQ;IAC/B,EAAE,OAAO,OAAO;QACd,MAAM,IAAI,gBAAgB;IAC5B;AACF"}},
    {"offset": {"line": 185, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/avbha/OneDrive/Desktop/projects/educify/app/api/courses/%5Bid%5D/enroll/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from \"next/server\";\nimport { prisma } from \"@/lib/prisma\";\nimport { successResponse, errorResponse } from \"@/lib/api-utils\";\n\nexport async function POST(\n  request: NextRequest,\n  context: { params: Promise<{ id: string }> }\n) {\n  try {\n    // Next.js App Router provides params as a Promise; unwrap before use\n    const { id: courseId } = await context.params;\n    const userId = request.headers.get(\"x-user-id\");\n\n    if (!userId) {\n      return NextResponse.json(errorResponse(\"Unauthorized\"), { status: 401 });\n    }\n\n    // Validate user exists in database\n    const user = await prisma.user.findUnique({ where: { id: userId } });\n    if (!user) {\n      return NextResponse.json(errorResponse(\"User not found\"), { status: 404 });\n    }\n\n    // Check course exists\n    const course = await prisma.course.findUnique({ where: { id: courseId } });\n    if (!course) {\n      return NextResponse.json(errorResponse(\"Course not found\"), { status: 404 });\n    }\n\n    // Check existing enrollment\n    const existing = await prisma.enrollment.findUnique({\n      where: { userId_courseId: { userId, courseId } },\n    });\n\n    if (existing) {\n      return NextResponse.json(errorResponse(\"Already enrolled\"), { status: 409 });\n    }\n\n    // Create enrollment\n    const enrollment = await prisma.enrollment.create({\n      data: {\n        userId,\n        courseId,\n        status: \"ACTIVE\",\n        progress: 0,\n        lastAccessed: new Date(),\n      },\n      include: {\n        course: {\n          select: {\n            id: true,\n            title: true,\n            instructor: true,\n            category: true,\n            difficulty: true,\n            duration: true,\n            thumbnail: true,\n            price: true,\n          },\n        },\n      },\n    });\n\n    // Increment course student count safely\n    try {\n      await prisma.course.update({ where: { id: courseId }, data: { studentsEnrolled: { increment: 1 } } });\n    } catch (e) {\n      // ignore if column doesn't exist\n      console.warn(\"Failed to increment studentsEnrolled\", e);\n    }\n\n    return NextResponse.json(successResponse(enrollment, \"Enrolled successfully\"), { status: 201 });\n  } catch (error) {\n    console.error(\"Enroll error:\", error);\n    return NextResponse.json(errorResponse(\"Failed to enroll\"), { status: 500 });\n  }\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;AACA;;;;AAEO,eAAe,KACpB,OAAoB,EACpB,OAA4C;IAE5C,IAAI;QACF,qEAAqE;QACrE,MAAM,EAAE,IAAI,QAAQ,EAAE,GAAG,MAAM,QAAQ,MAAM;QAC7C,MAAM,SAAS,QAAQ,OAAO,CAAC,GAAG,CAAC;QAEnC,IAAI,CAAC,QAAQ;YACX,OAAO,8LAAY,CAAC,IAAI,CAAC,IAAA,oLAAa,EAAC,iBAAiB;gBAAE,QAAQ;YAAI;QACxE;QAEA,mCAAmC;QACnC,MAAM,OAAO,MAAM,uKAAM,CAAC,IAAI,CAAC,UAAU,CAAC;YAAE,OAAO;gBAAE,IAAI;YAAO;QAAE;QAClE,IAAI,CAAC,MAAM;YACT,OAAO,8LAAY,CAAC,IAAI,CAAC,IAAA,oLAAa,EAAC,mBAAmB;gBAAE,QAAQ;YAAI;QAC1E;QAEA,sBAAsB;QACtB,MAAM,SAAS,MAAM,uKAAM,CAAC,MAAM,CAAC,UAAU,CAAC;YAAE,OAAO;gBAAE,IAAI;YAAS;QAAE;QACxE,IAAI,CAAC,QAAQ;YACX,OAAO,8LAAY,CAAC,IAAI,CAAC,IAAA,oLAAa,EAAC,qBAAqB;gBAAE,QAAQ;YAAI;QAC5E;QAEA,4BAA4B;QAC5B,MAAM,WAAW,MAAM,uKAAM,CAAC,UAAU,CAAC,UAAU,CAAC;YAClD,OAAO;gBAAE,iBAAiB;oBAAE;oBAAQ;gBAAS;YAAE;QACjD;QAEA,IAAI,UAAU;YACZ,OAAO,8LAAY,CAAC,IAAI,CAAC,IAAA,oLAAa,EAAC,qBAAqB;gBAAE,QAAQ;YAAI;QAC5E;QAEA,oBAAoB;QACpB,MAAM,aAAa,MAAM,uKAAM,CAAC,UAAU,CAAC,MAAM,CAAC;YAChD,MAAM;gBACJ;gBACA;gBACA,QAAQ;gBACR,UAAU;gBACV,cAAc,IAAI;YACpB;YACA,SAAS;gBACP,QAAQ;oBACN,QAAQ;wBACN,IAAI;wBACJ,OAAO;wBACP,YAAY;wBACZ,UAAU;wBACV,YAAY;wBACZ,UAAU;wBACV,WAAW;wBACX,OAAO;oBACT;gBACF;YACF;QACF;QAEA,wCAAwC;QACxC,IAAI;YACF,MAAM,uKAAM,CAAC,MAAM,CAAC,MAAM,CAAC;gBAAE,OAAO;oBAAE,IAAI;gBAAS;gBAAG,MAAM;oBAAE,kBAAkB;wBAAE,WAAW;oBAAE;gBAAE;YAAE;QACrG,EAAE,OAAO,GAAG;YACV,iCAAiC;YACjC,QAAQ,IAAI,CAAC,wCAAwC;QACvD;QAEA,OAAO,8LAAY,CAAC,IAAI,CAAC,IAAA,sLAAe,EAAC,YAAY,0BAA0B;YAAE,QAAQ;QAAI;IAC/F,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,iBAAiB;QAC/B,OAAO,8LAAY,CAAC,IAAI,CAAC,IAAA,oLAAa,EAAC,qBAAqB;YAAE,QAAQ;QAAI;IAC5E;AACF"}}]
}